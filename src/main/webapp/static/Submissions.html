<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <title>ERS Home</title>
    </head>
    <body>
        <div class="jumbotron text-center" style="background-color: #ffce2b; border-bottom: 5px solid #f2f2f2;" >
            <h1 id = "welcome" style="color: white; font-size: 45px;">Employee Reimbursement Page</h1>
        </div>

        <div class="section-1-container">
            <div class="container">
               <div class="row">
                  <div class="col-10 offset-1 col-lg-8 offset-lg-2 d-flex justify-content-center align-items-center">
                      <p>Fill out the form below to submit a reimbursement application</p>

                  </div> 
               </div>
                <div class="row">
                    <div class="col-10 offset-1 col-lg-8 offset-lg-2 d-flex justify-content-center align-items-center">
                        <div class="div-to-align">
                            <form class="form-vertical" role="form">
                                <div class="radio">
                                    <p>Enter the Reimbursement type:</p>
                                    <label>
                                        <input type="radio" name="submissionType" value=1>Travel
                                        <input type="radio" name="submissionType" value=2>Lodging
                                        <input type="radio" name="submissionType" value=3>Food
                                        <input type="radio" name="submissionType" value=4>Other
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label class="sr-only" for="firstName">First Name</label>
                                    <input type="text" class="form-control" id="firstName" placeholder="First Name">
                                    
                                    <label class="sr-only" for="lastName">Last Name</label>
                                    <input type="text" class="form-control" id="lastName" placeholder="Last Name">

                                    <label class="sr-only" for="userID">EID#</label>
                                    <input type="text" class="form-control" id="userID" placeholder="EID#">

                                    <label class="sr-only" for="email">E-mail</label>
                                    <input type="email" class="form-control" id="email" placeholder="E-mail">

                                    <label class="sr-only" for="description">Description</label>
                                    <input type="email" class="form-control" id="description" placeholder="description">
                                    
    								<!-- <label for="uploadReceipt">Upload</label>
    								<input type="file" class="form-control-file" id="receipt"> -->
    								<button type="submit" class="btn btn-default" id="submitForm">Submit</button>
									
									<button type="submit" class="btn btn-default" id="logout" >Logout</button>
                                </div>
                                
                            </form> 
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script
            src="https://code.jquery.com/jquery-3.5.1.min.js"
            integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
            crossorigin="anonymous">
        </script>
        <script>
            let button = document.getElementById("submitForm");
            button.addEventListener("click", submit);
            
            function submit() {
                console.log("in function");
                
                let subType;
                let radioElement = document.getElementsByName("submissionType"); 
                    for( i = 0; i < radioElement.length; i++) {
                        if(radioElement[i].checked){
                            subType = radioElement[i].value;
                        }
                    }
                console.log(subType);
                alert(subType);

				let firstNameInput = document.getElementById("firstName").value;
				let lastNameInput = document.getElementById("lastName").value;
                let eidInput = document.getElementById("userID").value;
                let emailInput = document.getElementById("email").value;
                // let receiptInput = document.getElementById("receipt").value;

                let formData = new FormData();
                formData.append("subType", subType)
                formData.append("firstName", firstNameInput);
                formData.append("lastName", lastNameInput);
                formData.append("eid", eidInput);
                formData.append("email", emailInput);
                // formData.append("receipt",receiptInput);
                
	
                let xhr = new XMLHttpRequest();
                    //this will not execute until you return a function
                xhr.onReadyState = function() {
                    if(this.readyState == 4) {
                        let data = JSON.parse(xhr.responseText);
                        console.log(data);
                    }
                }
                //you are opening a post request
                xhr.open("POST","http://localhost:8080/Project_1_Christopher_Castrillon/rest/reimbursements");
                xhr.send(JSON.stringify(Object.fromEntries(formData)));
             
            }
            
    
            // function logout() {
        	// 	console.log("The third function");
        	// 	window.location.assign("http://localhost:8080/Project_1_Christopher_Castrillon/logout");
        	// }
          
            // let currentUser = sessionStorage.getItem("currentUser");
            // if (!currentUser) {
            //     // logout();
            // }
            // let welcome = document.getElementById("welcome");
            // welcome.innerHTML += " " + currentUser;

        </script>
    </body>
</html>
